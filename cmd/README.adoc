= cmd.adoc
Alessandro Sanino <a.sanino@arduino.cc>

This package has all info regarding commands structure.
Made using Cobra Commander.

== How to add commands
One file per macro command (e.g. `arduino lib` `arduino core` etc...)
To add subCommands add a *cobra.Command var into the file corresponding parent command.
[source, go]
----
var newSubCommand := &cobra.Command{
    Use : "how to use the command",
    Short : "Short description",
    Long : `Long description
may be multiline too`,
    Run : attachedFunction, //must be defined outside the struct 
}

func attachedFunction(cmd *cobra.Command, args []string) {
    //do something.
}
----

then into the init function of that file add the following lines :

[source, go]
----
func init() {
    //....
    parentCommand.AddCommand(newSubCommand)
}
----

== Adding flags
It is possible to add flags to commands by using Flags() or GlobalFlags() functions of Cobra Commands.

.) Define a struct per command with his fields (only one struct for global flags)
[source, go]
----

var GlobalFlags struct {
    //.... my fields
    Example int,
}

var commandFlags struct {
    //.... commands fields
    Example2 int,
}

func init() {
    //....
    parentCommand.AddCommand(newSubCommand)
    // following lines add respectively global flags and local flags.
    // global flags can be accessed by any command.
    newSubCommand.GlobalFlags().IntvarP(&GlobalFlags.Example, ...)
    newSubCommand.Flags().IntvarP(&commandFlags.Example2, ...)
}
----